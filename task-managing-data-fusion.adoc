---
sidebar: sidebar 
permalink: task-managing-data-fusion.html 
keywords: data identifiers, personal data, sensitive personal data, compliance, data fusion, data sense 
summary: 'Data sense为您提供了多种方式来添加Data sense在未来扫描中将识别的自定义"个人数据"列表、让您全面了解潜在敏感数据在所有组织文件中的位置。' 
---
= 将个人数据标识符添加到Data sense扫描中
:hardbreaks:
:allow-uri-read: 
:nofooter: 
:icons: font
:linkattrs: 
:imagesdir: ./media/


[role="lead"]
Data sense为您提供了多种方式来添加Data sense在未来扫描中将识别的自定义"个人数据"列表、让您全面了解潜在敏感数据在组织的_all_文件中的位置。

* 您可以根据要扫描的数据库中的特定列添加唯一标识符。
* 您可以从文本文件中添加自定义关键字—这些字在数据中标识。
* 您可以使用正则表达式(regex)添加个人模式—正则表达式将添加到现有预定义模式中。



NOTE: 只有在选择对数据源执行完整分类扫描后，才可以使用本节所述的功能。已执行仅映射扫描的数据源不会显示文件级详细信息。



== 从数据库中添加自定义个人数据标识符

我们称为_Data Fusion _的一项功能可用于扫描组织的数据、以确定您的数据库中的唯一标识符是否位于任何其他数据源中。您可以通过在数据库表中选择特定列来选择Data sense在其扫描中查找的其他标识符。例如，下图显示了如何使用 Data Fusion 扫描卷，分段和数据库，以确定 Oracle 数据库中所有客户 ID 是否存在。

image:diagram_compliance_data_fusion.png["一个图，显示如何将数据库中的内容用作源来标识包含相同数据的文件。"]

如您所见，在两个卷和一个 S3 存储分段中发现了两个唯一的客户 ID 。此外，还将确定数据库表中的任何匹配项。

请注意、由于您正在扫描自己的数据库、因此无论您的数据存储使用何种语言、在未来的Data sense扫描中都将用于标识数据。

您必须拥有 link:task-scanning-databases.html#adding-the-database-server["已至少添加一个数据库服务器"^] 添加数据Fusion 源之前、请先将此消息添加到Data sense中。

. 在配置页面中，单击源数据所在数据库中的 * 管理 Data Fusion * 。
+
image:screenshot_compliance_manage_data_fusion.png["选择 Manage Data Fusion 按钮以添加源列的屏幕截图。"]

. 单击下一页的 * 添加 Data Fusion 源 * 。
. 在 _Add Data Fusion Sources_ 页面中：
+
.. 从下拉菜单中选择数据库架构。
.. 输入该模式中的表名称。
.. 输入包含要使用的唯一标识符的 Column 或 Columns 。
+
添加多个列时，请在单独的行中输入每个列名称或表视图名称。

+
image:screenshot_compliance_add_data_fusion.png["用于标识数据 Fusion 源的架构，表和列的屏幕截图。"]



. 单击 * 添加 Data Fusion 源 * 。
+
Data Fusion 清单页面显示您已将Data sense配置为扫描的数据库源列。

+
image:screenshot_compliance_data_fusion_list.png["您已使用 Data Fusion 配置的所有数据源引用的屏幕截图。"]



下次扫描后、结果将在"个人结果"部分的"合规性信息板"中以及"个人数据"筛选器的"调查"页面中包含此新信息。您添加的每个源列都会以"Table.Column"格式显示在筛选器列表中、例如`customers.CustomerID`。

image:screenshot_add_data_fusion_result.png["在\"调查结果\"窗格中显示Data Fusion 结果示例的屏幕截图。"]



=== 删除Data Fusion 源

如果您在某个时刻决定不使用某个 Data Fusion 源扫描文件，则可以从 Data Fusion 清单页面中选择源行，然后单击 * 删除 Data Fusion 源 * 。

image:screenshot_compliance_delete_data_fusion.png["显示如何删除数据 Fusion 源的屏幕截图。"]



== 从文本文件添加自定义关键字

您可以将自定义关键字添加到Data sense中、以便它可以识别数据中的特定信息。您可以从定义的文本文件添加关键字。这些关键字将添加到Data sense已使用的现有预定义关键字中、其结果将显示在"Personal Patterns"部分下。

例如、您可能希望查看所有文件中提及内部产品名称的位置、以确保这些名称在不安全的位置不可访问。

更新自定义关键字后、Data sense将重新开始扫描所有数据源-扫描完成后、新结果将显示在Data sense中。

您必须在Data sense系统的以下位置添加或创建包含自定义关键字的文本文件：

 /opt/netapp/Datasense/tools/datascience/custom_keywords/keywords_sets
您可以创建一个包含多个关键字的文件、也可以添加多个文件、每个文件都包含特定关键字。文件格式为每行一个字、例如、以下列出了属于owls类型的内部产品名称：

_internal_product_names.txt_

....
barred
barn
horned
snowy
screech
....
这些项目的数据感知搜索不区分大小写。

请注意以下要求：

* 文件名不应包含数字。
* 每个文件最多可包含100、000个字。如果存在更多字词、则仅添加前100、000个字。
* 每个词的长度必须至少为3个字符。较短的字词将被忽略。
* 重复词只会添加一次。




=== 访问命令行

您需要访问Data sense系统、才能启动命令以添加自定义关键字。

在内部安装Data sense后、您可以直接访问命令行。

在云中部署Data sense时、您需要通过SSH连接到Data sense实例。您可以通过输入用户和密码或使用在安装BlueXP Connector期间提供的SSH密钥通过SSH连接到系统。SSH命令为：

 ssh -i <path_to_the_ssh_key> <machine_user>@<datasense_ip>
* <path_to_the_ssh_key>= ssh身份验证密钥的位置
* <machine_user>：
+
** 对于AWS：使用<EC2-user>
** 对于Azure：使用为BlueXP实例创建的用户
** 对于GCP：使用为BlueXP实例创建的用户


* <datasens_ip>=虚拟机实例的IP地址


请注意、您需要修改安全组入站规则才能访问云上的系统。有关详细信息、请参见：

* https://docs.netapp.com/us-en/cloud-manager-setup-admin/reference-ports-aws.html["AWS中的安全组规则"^]
* https://docs.netapp.com/us-en/cloud-manager-setup-admin/reference-ports-azure.html["Azure中的安全组规则"^]
* https://docs.netapp.com/us-en/cloud-manager-setup-admin/reference-ports-gcp.html["Google Cloud中的防火墙规则"^]




=== 用于添加自定义关键字的命令语法

用于从文件添加自定义关键字的命令语法为：

 sudo bash tools/datascience/custom_keywords/upload_custom_keywords.sh -s activate -f <file_name>.txt
* <file_name>=此名称是包含关键字的文件的名称。


您可以从路径*/opt/netapp/Datasens/*运行命令。

如果您创建了许多包含自定义关键字的文件、则可以使用以下命令一次性添加所有文件中的关键字：

 sudo bash tools/datascience/custom_keywords/upload_custom_keywords.sh -s activate


=== 示例

要查看所有文件中提及内部产品名称的位置、请输入以下命令。

[source, cli]
----
[user ~]$ cd /opt/netapp/Datasense/
[user Datasense]$ sudo bash tools/datascience/custom_keywords/upload_custom_keywords.sh -s activate -f internal_product_names.txt
----
 log v1.0 | 2022-08-24 08:16:25,332 | INFO | ds_logger | upload_custom_keywords | 126 | 1 | None | upload_custom_keywords_126 | All legal keywords were successfully inserted
下次扫描后、结果将在"个人结果"部分的"合规性信息板"中以及"个人数据"筛选器的"调查"页面中包含此新信息。

image:screenshot_add_keywords_result.png["在\"调查结果\"窗格中显示自定义关键字结果示例的屏幕截图。"]

如您所见、文本文件的名称将在"个人结果"面板中用作名称。通过这种方式、您可以激活不同文本文件中的关键字、并查看每种关键字类型的结果。



=== 停用自定义关键字

如果您稍后确定不需要Data sense来识别您先前添加的某些自定义关键字、请使用命令中的*停用*选项删除文本文件中定义的关键字。

 sudo bash tools/datascience/custom_keywords/upload_custom_keywords.sh -s deactivate -f <file_name>.txt
例如、要删除文件* internal_product_names.txt*中定义的关键字：

[source, cli]
----
[user ~]$ cd /opt/netapp/Datasense/
[user Datasense]$ sudo bash tools/datascience/custom_keywords/upload_custom_keywords.sh -s deactivate -f internal_product_names.txt
----
 log v1.0 | 2022-08-24 08:16:25,332 | INFO | ds_logger | upload_custom_keywords | 87 | 1 | None | upload_custom_keywords_87 | Deactivated keyword pattern from internal_product_names.txt successfully


== 使用正则表达式添加自定义个人数据标识符

您可以使用自定义正则表达式(regex)添加个人模式来标识数据中的特定信息。该正则表达式将添加到Data sense已使用的现有预定义模式中、其结果将显示在"Personal Patterns"部分下。

例如、您可能希望查看所有文件中提及内部产品ID的位置。如果产品ID结构清晰、例如、它是一个以201开头的12位数、则可以使用自定义正则表达式功能在文件中搜索它。

添加regex后、Data sense将重新开始扫描所有数据源-扫描完成后、新结果将显示在Data sense中。



=== 用于添加regex的命令语法

您需要访问Data sense系统、以便添加包含自定义关键字模式的文件、并启动命令以添加自定义关键字。  the command line,请参见如何访问命令行 无论您是在内部安装了Data sense、还是在云中部署了Data sense。

用于添加自定义regex的命令语法为：

 sudo bash tools/datascience/custom_regex/custom_regex.sh -s activate -n "<pattern_name>" -r "<regular_expression>"
* <pattern_name>=此名称将显示在Data sense UI中。确保此名称标识了正则表达式的设计用途。此名称必须至少包含一个字母、并且长度最多可以包含70个字符。
* <Regular expression>=这可以是任何合法的正则表达式。


您可以从路径*/opt/netapp/Datasens/*运行命令。

请注意、我们会测试每个新的正则表达式、以验证它是否过宽且返回的匹配项过多。如果是这种情况、则会显示以下日志消息：

 log v1.0 | 2022-08-17 07:24:19,585 | ERROR | ds_logger | custom_regex | 119 | 1 | None | custom_regex_119 | The regex has high risk to identify false positives. Please narrow the regular expression and try again. To add it anyway, use the force flag (-f) at the end
如果要将regex强制添加到Data sense中、您可以使用命令行末尾的*—f*选项、即使我们认为该regex过于宽泛也是如此。



=== 示例

产品ID是一个12位数、以201开头；因此正则表达式为*：\B201\d｛9｝\b*。您希望通过Data sense UI中的文本将此模式标识为*内部产品ID*。

要查看所有文件中提及内部产品ID的位置、请输入以下命令。

[source, cli]
----
[user ~]$ cd /opt/netapp/Datasense/
[user Datasense]$ sudo bash tools/datascience/custom_regex/custom_regex.sh -s activate -n "Internal Product ID" -r "\b201\d{9}\b"
----
....
[+] Adding Custom Regex to Data Sense
log v1.0 | 2022-08-23 13:19:01,476 | INFO | ds_logger | custom_regex | 154 | 1 | None | custom_regex_154 | A pattern named 'Internal Product ID' was added successfully to Data Sense
....
下次扫描后、结果将在"个人结果"部分的"合规性信息板"中以及"个人数据"筛选器的"调查"页面中包含此新信息。

image:screenshot_add_regex_result.png["在\"调查结果\"窗格中显示自定义正则表达式结果示例的屏幕截图。"]



=== 停用自定义正则表达式

如果您稍后确定不需要Data sense来识别作为regex输入的自定义模式、请使用命令中的*停用*选项删除每个regex。

 sudo bash tools/datascience/custom_regex/custom_regex.sh -s deactivate -n "<pattern name>"
例如、要删除*内部产品ID* regex：

[source, cli]
----
[user ~]$ cd /opt/netapp/Datasense/
[user Datasense]$ sudo bash tools/datascience/custom_regex/custom_regex.sh -s deactivate -n "Internal Product ID"
----
 log v1.0 | 2022-08-17 09:13:15,431 | INFO | ds_logger | custom_regex | 31 | 1 | None | custom_regex_31 | A pattern named 'Internal Product ID' was deactivated successfully